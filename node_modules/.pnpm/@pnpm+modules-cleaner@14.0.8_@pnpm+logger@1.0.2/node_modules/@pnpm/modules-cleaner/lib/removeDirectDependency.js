"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.removeDirectDependency = void 0;
const path_1 = __importDefault(require("path"));
const core_loggers_1 = require("@pnpm/core-loggers");
const remove_bins_1 = require("@pnpm/remove-bins");
async function removeDirectDependency(dependency, opts) {
    const dependencyDir = path_1.default.join(opts.modulesDir, dependency.name);
    const results = await Promise.all([
        (0, remove_bins_1.removeBinsOfDependency)(dependencyDir, opts),
        !opts.dryRun && (0, remove_bins_1.removeBin)(dependencyDir), // eslint-disable-line @typescript-eslint/no-explicit-any
    ]);
    const uninstalledPkg = results[0];
    if (!opts.muteLogs) {
        core_loggers_1.rootLogger.debug({
            prefix: opts.rootDir,
            removed: {
                dependencyType: dependency.dependenciesField === 'devDependencies' && 'dev' ||
                    dependency.dependenciesField === 'optionalDependencies' && 'optional' ||
                    dependency.dependenciesField === 'dependencies' && 'prod' ||
                    undefined,
                name: dependency.name,
                version: uninstalledPkg?.version,
            },
        });
    }
}
exports.removeDirectDependency = removeDirectDependency;
//# sourceMappingURL=removeDirectDependency.js.map