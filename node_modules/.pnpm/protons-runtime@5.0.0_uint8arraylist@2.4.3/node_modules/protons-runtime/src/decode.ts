import type { Uint8ArrayList } from 'uint8arraylist'

import type { Codec } from '.pnpm/protons-runtime@5.0.0_uint8arraylist@2.4.3/node_modules/protons-runtime/src/codec.js'
import { reader } from '.pnpm/protons-runtime@5.0.0_uint8arraylist@2.4.3/node_modules/protons-runtime/src/utils.js'

export function decodeMessage <T> (buf: Uint8Array | Uint8ArrayList, codec: Codec<T>): T {
  const r = reader(buf instanceof Uint8Array ? buf : buf.subarray())

  return codec.decode(r)
}
