"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.removeDeps = void 0;
const core_loggers_1 = require("@pnpm/core-loggers");
const types_1 = require("@pnpm/types");
async function removeDeps(packageManifest, removedPackages, opts) {
    if (opts.saveType) {
        if (packageManifest[opts.saveType] == null)
            return packageManifest;
        removedPackages.forEach((dependency) => {
            delete packageManifest[opts.saveType][dependency];
        });
    }
    else {
        types_1.DEPENDENCIES_FIELDS
            .filter((depField) => packageManifest[depField])
            .forEach((depField) => {
            removedPackages.forEach((dependency) => {
                delete packageManifest[depField][dependency];
            });
        });
    }
    if (packageManifest.peerDependencies != null) {
        for (const removedDependency of removedPackages) {
            delete packageManifest.peerDependencies[removedDependency];
        }
    }
    if (packageManifest.dependenciesMeta != null) {
        for (const removedDependency of removedPackages) {
            delete packageManifest.dependenciesMeta[removedDependency];
        }
    }
    core_loggers_1.packageManifestLogger.debug({
        prefix: opts.prefix,
        updated: packageManifest,
    });
    return packageManifest;
}
exports.removeDeps = removeDeps;
//# sourceMappingURL=removeDeps.js.map